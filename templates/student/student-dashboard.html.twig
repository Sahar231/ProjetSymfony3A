{% extends 'base.html.twig' %}

{% block title %}Student Dashboard - Eduport{% endblock %}

{% block body %}
<!-- **************** MAIN CONTENT START **************** -->
<main>
	
<!-- =======================
Page Banner START -->
<section class="pt-0">
	<div class="container-fluid px-0">
		<div class="card bg-blue h-100px h-md-200px rounded-0" style="background:url(/assets/images/pattern/04.png) no-repeat center center; background-size:cover;">
		</div>
	</div>
	<div class="container mt-n4">
		<div class="row">
			<div class="col-12">
				<div class="card bg-transparent card-body pb-0 px-0 mt-2 mt-sm-0">
					<div class="row d-sm-flex justify-sm-content-between mt-2 mt-md-0">
						<!-- Avatar -->
						<div class="col-auto">
							<div class="avatar avatar-xxl mt-n3">
								<img class="avatar-img rounded-circle border border-white border-3 shadow" src="/assets/images/avatar/09.jpg" alt="">
							</div>
						</div>
						<!-- Profile info -->
						<div class="col d-sm-flex justify-content-between align-items-center">
							<div>
								<h1 class="my-1 fs-4">{{ app.user.fullName }}</h1>
								<ul class="list-inline mb-0">
									<li class="list-inline-item me-3 mb-1 mb-sm-0">
										<span class="h6">255</span>
										<span class="text-body fw-light">points</span>
									</li>
									<li class="list-inline-item me-3 mb-1 mb-sm-0">
										<span class="h6">7</span>
										<span class="text-body fw-light">Completed courses</span>
									</li>
									<li class="list-inline-item me-3 mb-1 mb-sm-0">
										<span class="h6">52</span>
										<span class="text-body fw-light">Completed lessons</span>
									</li>
								</ul>
							</div>
							<!-- Button -->
							<div class="mt-2 mt-sm-0">
								<a href="#" class="btn btn-outline-primary mb-0">View my courses</a>
							</div>
						</div>
					</div>
				</div>

				<!-- Advanced filter responsive toggler START -->
				<!-- Divider -->
				<hr class="d-xl-none">
				<div class="col-12 col-xl-3 d-flex justify-content-between align-items-center">
					<a class="h6 mb-0 fw-bold d-xl-none" href="#">Menu</a>
					<button class="btn btn-primary d-xl-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar">
						<i class="fas fa-sliders-h"></i>
					</button>
				</div>
				<!-- Advanced filter responsive toggler END -->
			</div>
		</div>
	</div>
</section>
<!-- =======================
Page Banner END -->

<!-- =======================
Page content START -->
<section class="pt-0">
	<div class="container">
		<div class="row">

			<!-- Left sidebar START -->
			<div class="col-xl-3">
				<!-- Responsive offcanvas body START -->
				<div class="offcanvas-xl offcanvas-end" tabindex="-1" id="offcanvasSidebar">
					<!-- Offcanvas header -->
					<div class="offcanvas-header bg-light">
						<h5 class="offcanvas-title" id="offcanvasNavbarLabel">My profile</h5>
						<button  type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#offcanvasSidebar" aria-label="Close"></button>
					</div>
					<!-- Offcanvas body -->
					<div class="offcanvas-body p-3 p-xl-0">
						<div class="bg-dark border rounded-3 p-3 w-100">
							<!-- Dashboard menu -->
							<div class="list-group list-group-dark list-group-borderless collapse-list">
								<a class="list-group-item active" href="{{ path('student_dashboard') }}"><i class="bi bi-ui-checks-grid fa-fw me-2"></i>Dashboard</a>
								<a class="list-group-item" href="{{ path('student_formations') }}"><i class="fas fa-graduation-cap fa-fw me-2"></i>My Formations</a>
								<a class="list-group-item" href="{{ path('student_quiz_available') }}"><i class="bi bi-question-diamond fa-fw me-2"></i>Quiz</a>
								<a class="list-group-item" href="{{ path('student_quiz_results') }}"><i class="fas fa-tasks fa-fw me-2"></i>My Quizzes</a>
								<a class="list-group-item" href="{{ path('student_wallet_index') }}"><i class="bi bi-wallet2 fa-fw me-2"></i>My Wallet</a>
								<a class="list-group-item" href="{{ path('student_certificate_index') }}"><i class="fas fa-medal fa-fw me-2"></i>My Certificates</a>
								<a class="list-group-item" href="#"><i class="bi bi-card-checklist fa-fw me-2"></i>My Subscriptions</a>
								<a class="list-group-item" href="#"><i class="bi bi-basket fa-fw me-2"></i>My Courses</a>
								<a class="list-group-item" href="#"><i class="far fa-fw fa-file-alt me-2"></i>Course Resume</a>
								<a class="list-group-item" href="#"><i class="bi bi-credit-card-2-front fa-fw me-2"></i>Payment Info</a>
								<a class="list-group-item" href="#"><i class="bi bi-cart-check fa-fw me-2"></i>Wishlist</a>
								<a class="list-group-item" href="{{ path('student_profile_edit') }}"><i class="bi bi-pencil-square fa-fw me-2"></i>Edit Profile</a>
								<a class="list-group-item" href="#"><i class="bi bi-gear fa-fw me-2"></i>Settings</a>
								<a class="list-group-item" href="#"><i class="bi bi-trash fa-fw me-2"></i>Delete Profile</a>
								<a class="list-group-item text-danger bg-danger-soft-hover" href="{{ path('app_logout') }}"><i class="fas fa-sign-out-alt fa-fw me-2"></i>Sign Out</a>
							</div>
						</div>
					</div>
				</div>
				<!-- Responsive offcanvas body END -->
			</div>
			<!-- Left sidebar END -->

			<!-- Main content START -->
			<div class="col-xl-9">

				<!-- Counter boxes START -->
				<div class="row mb-4">
					<!-- Counter item -->
					<div class="col-sm-6 col-lg-4 mb-3 mb-lg-0">
						<div class="d-flex justify-content-center align-items-center p-4 bg-orange bg-opacity-15 rounded-3">
							<span class="display-6 lh-1 text-orange mb-0"><i class="fas fa-tv fa-fw"></i></span>
							<div class="ms-4">
								<div class="d-flex">
									<h5 class="purecounter mb-0 fw-bold" data-purecounter-start="0" data-purecounter-end="9"	data-purecounter-delay="200">0</h5>
								</div>
								<p class="mb-0 h6 fw-light">Total Courses</p>
							</div>
						</div>
					</div>
					<!-- Counter item -->
					<div class="col-sm-6 col-lg-4 mb-3 mb-lg-0">
						<div class="d-flex justify-content-center align-items-center p-4 bg-purple bg-opacity-15 rounded-3">
							<span class="display-6 lh-1 text-purple mb-0"><i class="fas fa-clipboard-check fa-fw"></i></span>
							<div class="ms-4">
								<div class="d-flex">
									<h5 class="purecounter mb-0 fw-bold" data-purecounter-start="0" data-purecounter-end="52"	data-purecounter-delay="200">0</h5>
								</div>
								<p class="mb-0 h6 fw-light">Complete lessons</p>
							</div>
						</div>
					</div>
					<!-- Counter item -->
					<div class="col-sm-6 col-lg-4 mb-3 mb-lg-0">
						<div class="d-flex justify-content-center align-items-center p-4 bg-success bg-opacity-10 rounded-3">
							<span class="display-6 lh-1 text-success mb-0"><i class="fas fa-medal fa-fw"></i></span>
							<div class="ms-4">
								<div class="d-flex">
									<h5 class="purecounter mb-0 fw-bold" data-purecounter-start="0" data-purecounter-end="8" data-purecounter-delay="300">0</h5>
								</div>
								<p class="mb-0 h6 fw-light">Achieved Certificates</p>
							</div>
						</div>
					</div>
				</div>
				<!-- Counter boxes END -->

				<!-- My Clubs Section START -->
				<div class="row mb-4 g-4">
					<!-- Clubs Header -->
					<div class="col-12">
						<div class="d-flex justify-content-between align-items-center mb-3">
							<div>
								<h3 class="mb-1"><i class="fas fa-users me-2 text-primary"></i>My Clubs</h3>
								<p class="text-muted mb-0">Join and manage your club memberships</p>
							</div>
							<a href="{{ path('student_club_list') }}" class="btn btn-primary">View All Clubs</a>
						</div>
					</div>

					<!-- My Clubs Display -->
					{% if myClubs|length > 0 %}
						{% for club in myClubs|slice(0, 3) %}
							<div class="col-md-6 col-lg-4">
								<div class="card card-hover h-100 shadow-sm border-0">
									<div class="card-body">
										<div class="d-flex justify-content-between align-items-start mb-2">
											<h6 class="card-title mb-0">{{ club.name }}</h6>
											<span class="badge bg-success rounded-pill">Member</span>
										</div>
										{% if club.description %}
											<p class="card-text text-muted small mb-3" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
												{{ club.description|striptags|slice(0, 80) }}...
											</p>
										{% endif %}
										<small class="text-muted d-block mb-2">
											<i class="fas fa-users me-1"></i>{{ club.members|length }} members
										</small>
										<small class="text-muted d-block mb-3">
											<i class="fas fa-calendar me-1"></i>{{ club.createdAt|date('M d, Y') }}
										</small>
										<a href="{{ path('student_club_show', { id: club.id }) }}" class="btn btn-sm btn-outline-primary w-100">
											<i class="fas fa-eye me-1"></i>View Club
										</a>
									</div>
								</div>
							</div>
						{% endfor %}

						{% if myClubs|length > 3 %}
							<div class="col-md-6 col-lg-4">
								<div class="card h-100 border-2 border-primary shadow-sm d-flex align-items-center justify-content-center" style="min-height: 300px;">
									<div class="card-body text-center">
										<h5>See More Clubs</h5>
										<p class="text-muted mb-3">You have {{ myClubs|length - 3 }} more clubs</p>
										<a href="{{ path('student_club_list') }}" class="btn btn-primary btn-sm">View All</a>
									</div>
								</div>
							</div>
						{% endif %}
					{% else %}
						<div class="col-12">
							<div class="alert alert-info border-info border-2">
								<i class="bi bi-info-circle me-2"></i>You haven't joined any clubs yet. <a href="{{ path('student_club_list') }}">Browse available clubs</a>
							</div>
						</div>
					{% endif %}
				</div>
				<!-- My Clubs Section END -->

				<!-- Formations Section START -->
				<div class="row mb-4 g-4">
					<!-- Formations Header -->
					<div class="col-12">
						<div class="d-flex justify-content-between align-items-center mb-3">
							<div>
								<h3 class="mb-1"><i class="fas fa-graduation-cap me-2 text-primary"></i>My Formations</h3>
								<p class="text-muted mb-0">Manage your enrolled formations</p>
							</div>
							<a href="{{ path('student_formations') }}" class="btn btn-primary">View All Formations</a>
						</div>
					</div>

					<!-- Enrolled Formations Display -->
					{% if enrolledFormations|length > 0 %}
						{% for formation in enrolledFormations|slice(0, 3) %}
							<div class="col-md-6 col-lg-4">
								<div class="card card-hover h-100 shadow-sm border-0">
									<div class="card-body">
										<div class="d-flex justify-content-between align-items-start mb-2">
											<h6 class="card-title mb-0">{{ formation.title }}</h6>
											<span class="badge bg-success rounded-pill">Enrolled</span>
										</div>
										{% if formation.description %}
											<p class="card-text text-muted small mb-3" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
												{{ formation.description|striptags|slice(0, 80) }}...
											</p>
										{% endif %}
										<small class="text-muted d-block mb-3">
											<i class="far fa-calendar me-1"></i>{{ formation.createdAt|date('M d, Y') }}
										</small>
										<a href="{{ path('student_formation_view', { id: formation.id }) }}" class="btn btn-sm btn-outline-primary w-100">
											<i class="fas fa-eye me-1"></i>View Details
										</a>
									</div>
								</div>
							</div>
						{% endfor %}

						{% if enrolledFormations|length > 3 %}
							<div class="col-md-6 col-lg-4">
								<div class="card h-100 border-2 border-primary shadow-sm d-flex align-items-center justify-content-center" style="min-height: 300px;">
									<div class="card-body text-center">
										<h5 class="card-title mb-2">More Formations</h5>
										<p class="text-muted mb-3">You have {{ enrolledFormations|length - 3 }} more formations</p>
										<a href="{{ path('student_formations') }}" class="btn btn-primary btn-sm">
											<i class="fas fa-arrow-right me-1"></i>View All
										</a>
									</div>
								</div>
							</div>
						{% endif %}
					{% else %}
						<div class="col-12">
							<div class="card border-0 shadow-sm bg-light" style="min-height: 300px;">
								<div class="card-body d-flex flex-column align-items-center justify-content-center text-center py-5">
									<div class="mb-4">
										<i class="fas fa-book-open" style="font-size: 4rem; color: #0d6efd; opacity: 0.3;"></i>
									</div>
									<h4 class="card-title fw-bold mb-2">Start Your Learning Journey</h4>
									<p class="text-muted mb-4 fs-5">
										You haven't enrolled in any formations yet. Explore our available formations and start learning today!
									</p>
									<div class="d-flex gap-2">
										<a href="{{ path('student_formations') }}" class="btn btn-primary btn-lg">
											<i class="fas fa-compass me-2"></i>Explore Formations
										</a>
										<a href="{{ path('student_formations') }}" class="btn btn-outline-primary btn-lg">
											<i class="fas fa-search me-2"></i>Browse All
										</a>
									</div>
								</div>
							</div>
						</div>
					{% endif %}
				</div>
				<!-- Formations Section END -->

				<div class="card bg-transparent border rounded-3">
					<!-- Card header START -->
					<div class="card-header bg-transparent border-bottom">
						<h3 class="mb-0">My Courses List</h3>
					</div>
					<!-- Card header END -->

					<!-- Card body START -->
					<div class="card-body">
                        <p class="text-center">Bienvenue sur votre tableau de bord, {{ app.user.fullName }}!</p>
					</div>
					<!-- Card body END -->
				</div>
			</div>
			<!-- Main content END -->
		</div><!-- Row END -->
	</div>
</section>
<!-- =======================
Page content END -->

</main>
<!-- **************** MAIN CONTENT END **************** -->
{% endblock %}
